{"version":3,"file":"createCandyMachine.mjs","sources":["../../../../../src/plugins/candyMachineModule/operations/createCandyMachine.ts"],"sourcesContent":["import { createInitializeInstruction } from '@metaplex-foundation/mpl-candy-machine-core';\nimport { Keypair } from '@solana/web3.js';\nimport { SendAndConfirmTransactionResponse } from '../../rpcModule';\nimport { CandyGuardsSettings, DefaultCandyGuardSettings } from '../guards';\nimport {\n  CandyMachine,\n  CandyMachineConfigLineSettings,\n  CandyMachineHiddenSettings,\n  toCandyMachineData,\n  getCandyMachineSize,\n} from '../models';\nimport { TransactionBuilder, TransactionBuilderOptions } from '@/utils';\nimport {\n  BigNumber,\n  Creator,\n  isSigner,\n  makeConfirmOptionsFinalizedOnMainnet,\n  Operation,\n  OperationHandler,\n  OperationScope,\n  PublicKey,\n  Signer,\n  toBigNumber,\n  toPublicKey,\n} from '@/types';\nimport { Metaplex } from '@/Metaplex';\nimport { ExpectedSignerError } from '@/errors';\n\n// -----------------\n// Operation\n// -----------------\n\nconst Key = 'CreateCandyMachineOperation' as const;\n\n/**\n * Creates a brand new Candy Machine with the provided settings.\n *\n * Unless the `withoutCandyGuard` option is set to `true`, a\n * Candy Guard will be created with the given guards and\n * immediately linked to the Candy Machine.\n *\n * ```ts\n *  const { candyMachine } = await metaplex\n *    .candyMachines()\n *    .create({\n *      itemsAvailable: toBigNumber(5000),\n *      sellerFeeBasisPoints: 333, // 3.33%\n *      collection: {\n *        address: collectionNft.address,\n *        updateAuthority: collectionUpdateAuthority,\n *      },\n *    });\n * ```\n *\n * @group Operations\n * @category Constructors\n */\nexport const createCandyMachineOperation = _createCandyMachineOperation;\n// eslint-disable-next-line @typescript-eslint/naming-convention\nfunction _createCandyMachineOperation<\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n>(input: CreateCandyMachineInput<T>): CreateCandyMachineOperation<T> {\n  return { key: Key, input };\n}\n_createCandyMachineOperation.key = Key;\n\n/**\n * @group Operations\n * @category Types\n */\nexport type CreateCandyMachineOperation<\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n> = Operation<\n  typeof Key,\n  CreateCandyMachineInput<T>,\n  CreateCandyMachineOutput<T>\n>;\n\n/**\n * @group Operations\n * @category Inputs\n */\nexport type CreateCandyMachineInput<\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n> = {\n  /**\n   * The Candy Machine to create as a Signer.\n   * This expects a brand new Keypair with no associated account.\n   *\n   * @defaultValue `Keypair.generate()`\n   */\n  candyMachine?: Signer;\n\n  /**\n   * Refers to the authority that is allowed to manage the Candy Machine.\n   * This includes updating its data, authorities, inserting items, etc.\n   *\n   * By default, it is required as a Signer in order to create and wrap its\n   * Candy Guard. However, when `withoutCandyGuard` is set to `true`, it\n   * may be provided as a PublicKey instead.\n   *\n   * @defaultValue `metaplex.identity()`\n   */\n  authority?: PublicKey | Signer;\n\n  /**\n   * The Collection NFT that all NFTs minted from this Candy Machine should be part of.\n   * This must include its address and the update authority as a Signer.\n   *\n   * @example\n   * If you do not have a Collection NFT yet, you can create one using\n   * the `create` method of the NFT module and setting `isCollection` to `true`.\n   *\n   * ```ts\n   * const { nft } = await metaplex.\n   *   .nfts()\n   *   .create({ isCollection: true, name: 'My Collection', ... });\n   * ```\n   *\n   * You can now use `nft.address` as the address of the collection and\n   * provide the update authority as a signer, which by default, should\n   * be `metaplex.identity()`.\n   */\n  collection: {\n    address: PublicKey;\n    updateAuthority: Signer;\n  };\n\n  /**\n   * The royalties that should be set on minted NFTs in basis points.\n   *\n   * @example\n   * ```ts\n   * { sellerFeeBasisPoints: 250 } // For 2.5% royalties.\n   * ```\n   */\n  sellerFeeBasisPoints: number;\n\n  /**\n   * The total number of items availble in the Candy Machine, minted or not.\n   *\n   * @example\n   * ```ts\n   * { itemsAvailable: toBigNumber(1000) } // For 1000 items.\n   * ```\n   */\n  itemsAvailable: BigNumber;\n\n  /**\n   * Settings related to the Candy Machine's items.\n   *\n   * These can either be inserted manually within the Candy Machine or\n   * they can be infered from a set of hidden settings.\n   *\n   * - If `type` is `hidden`, the Candy Machine is using hidden settings.\n   * - If `type` is `configLines`, the Candy Machine is using config line settings.\n   *\n   * @defaultValue\n   * Defaults to using `configLines` settings with:\n   * - No prefixes.\n   * - A length of 32 for the name.\n   * - A length of 200 for the URI.\n   * - Random mint ordering.\n   *\n   * ```ts\n   * {\n   *   itemSettings: {\n   *     type: 'configLines',\n   *     prefixName: '',\n   *     nameLength: 32,\n   *     prefixUri: '',\n   *     uriLength: 200,\n   *     isSequential: false,\n   *   }\n   * }\n   * ```\n   *\n   * @see {@link CandyMachineHiddenSettings}\n   * @see {@link CandyMachineConfigLineSettings}\n   */\n  itemSettings?: CandyMachineHiddenSettings | CandyMachineConfigLineSettings;\n\n  /**\n   * The symbol to use when minting NFTs (e.g. \"MYPROJECT\")\n   *\n   * This can be any string up to 10 bytes and can be made optional\n   * by providing an empty string.\n   *\n   * @defaultValue `\"\"`\n   */\n  symbol?: string;\n\n  /**\n   * The maximum number of editions that can be printed from the\n   * minted NFTs.\n   *\n   * For most use cases, you'd want to set this to `0` to prevent\n   * minted NFTs to be printed multiple times.\n   *\n   * Note that you cannot set this to `null` which means unlimited editions\n   * are not supported by the Candy Machine program.\n   *\n   * @defaultValue `toBigNumber(0)`\n   */\n  maxEditionSupply?: BigNumber;\n\n  /**\n   * Whether the minted NFTs should be mutable or not.\n   *\n   * We recommend setting this to `true` unless you have a specific reason.\n   * You can always make NFTs immutable in the future but you cannot make\n   * immutable NFTs mutable ever again.\n   *\n   * @defaultValue `true`\n   */\n  isMutable?: boolean;\n\n  /**\n   * Array of creators that should be set on minted NFTs.\n   *\n   * @see {@link Creator}\n   *\n   * @defaultValue\n   * Defaults to using the `authority` parameter as the only creator.\n   *\n   * ```ts\n   * [{ address: authority, share: 100 }]\n   * ```\n   */\n  creators?: Omit<Creator, 'verified'>[];\n\n  /**\n   * The settings of all guards we wish to activate.\n   *\n   * Any guard not provided or set to `null` will be disabled.\n   *\n   * This parameter is ignored if `withoutCandyGuard` is set to `true`.\n   *\n   * @defaultValue `{}`, i.e. no guards are activated.\n   */\n  guards?: Partial<T>;\n\n  /**\n   * This parameter allows us to create multiple minting groups that have their\n   * own set of requirements â€” i.e. guards.\n   *\n   * When groups are provided, the `guards` parameter becomes a set of default\n   * guards that will be applied to all groups. If a specific group enables\n   * a guard that is also present in the default guards, the group's guard\n   * will override the default guard.\n   *\n   * For each group, any guard not provided or set to `null` will be disabled.\n   *\n   * This parameter is ignored if `withoutCandyGuard` is set to `true`.\n   *\n   * @defaultValue `[]`, i.e. no groups are created.\n   */\n  groups?: { label: string; guards: Partial<T> }[];\n\n  /**\n   * Whether to skip the part of this operation that creates a Candy Guard\n   * for the new Candy Machine. When set to `true`, no Candy Guard will be\n   * created for the Candy Machine.\n   *\n   * @defaultValue `false`\n   */\n  withoutCandyGuard?: boolean;\n};\n\n/**\n * @group Operations\n * @category Outputs\n */\nexport type CreateCandyMachineOutput<\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n> = {\n  /** The blockchain response from sending and confirming the transaction. */\n  response: SendAndConfirmTransactionResponse;\n\n  /** The Candy Machine that was created. */\n  candyMachine: CandyMachine<T>;\n\n  /** The created Candy Machine has a Signer. */\n  candyMachineSigner: Signer;\n};\n\n/**\n * @group Operations\n * @category Handlers\n */\nexport const createCandyMachineOperationHandler: OperationHandler<CreateCandyMachineOperation> =\n  {\n    async handle<T extends CandyGuardsSettings = DefaultCandyGuardSettings>(\n      operation: CreateCandyMachineOperation<T>,\n      metaplex: Metaplex,\n      scope: OperationScope\n    ) {\n      const builder = await createCandyMachineBuilder(\n        metaplex,\n        operation.input,\n        scope\n      );\n      scope.throwIfCanceled();\n\n      const confirmOptions = makeConfirmOptionsFinalizedOnMainnet(\n        metaplex,\n        scope.confirmOptions\n      );\n      const output = await builder.sendAndConfirm(metaplex, confirmOptions);\n      scope.throwIfCanceled();\n\n      const candyMachine = await metaplex\n        .candyMachines()\n        .findByAddress<T>(\n          { address: output.candyMachineSigner.publicKey },\n          scope\n        );\n      scope.throwIfCanceled();\n\n      return { ...output, candyMachine };\n    },\n  };\n\n// -----------------\n// Builder\n// -----------------\n\n/**\n * @group Transaction Builders\n * @category Inputs\n */\nexport type CreateCandyMachineBuilderParams<\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n> = Omit<CreateCandyMachineInput<T>, 'confirmOptions'> & {\n  /** A key to distinguish the instruction that creates the Candy Machine account. */\n  createCandyMachineAccountInstructionKey?: string;\n\n  /** A key to distinguish the instruction that initializes the Candy Machine account. */\n  initializeCandyMachineInstructionKey?: string;\n\n  /** A key to distinguish the instruction that wraps the Candy Machine in a Candy Guard. */\n  wrapCandyGuardInstructionKey?: string;\n};\n\n/**\n * @group Transaction Builders\n * @category Contexts\n */\nexport type CreateCandyMachineBuilderContext = Omit<\n  CreateCandyMachineOutput,\n  'response' | 'candyMachine'\n>;\n\n/**\n\n * Creates a brand new Candy Machine with the provided settings.\n *\n * Unless the `withoutCandyGuard` option is set to `true`, a\n * Candy Guard will be created with the given guards and\n * immediately linked to the Candy Machine.\n *\n * ```ts\n *  const transactionBuilder = await metaplex\n *    .candyMachines()\n *    .builders()\n *    .create({\n *      itemsAvailable: toBigNumber(5000),\n *      sellerFeeBasisPoints: 333, // 3.33%\n *      collection: {\n *        address: collectionNft.address,\n *        updateAuthority: collectionUpdateAuthority,\n *      },\n *    });\n * ```\n *\n * @group Transaction Builders\n * @category Constructors\n */\nexport const createCandyMachineBuilder = async <\n  T extends CandyGuardsSettings = DefaultCandyGuardSettings\n>(\n  metaplex: Metaplex,\n  params: CreateCandyMachineBuilderParams<T>,\n  options: TransactionBuilderOptions = {}\n): Promise<TransactionBuilder<CreateCandyMachineBuilderContext>> => {\n  // Input.\n  const { programs, payer = metaplex.rpc().getDefaultFeePayer() } = options;\n  const {\n    candyMachine = Keypair.generate(),\n    authority = metaplex.identity(),\n    collection,\n    sellerFeeBasisPoints,\n    itemsAvailable,\n    symbol = '',\n    maxEditionSupply = toBigNumber(0),\n    isMutable = true,\n    withoutCandyGuard = false,\n  } = params;\n  const creators = params.creators ?? [\n    { address: toPublicKey(authority), share: 100 },\n  ];\n  const itemSettings = params.itemSettings ?? {\n    type: 'configLines',\n    prefixName: '',\n    nameLength: 32,\n    prefixUri: '',\n    uriLength: 200,\n    isSequential: false,\n  };\n\n  // PDAs.\n  const authorityPda = metaplex.candyMachines().pdas().authority({\n    candyMachine: candyMachine.publicKey,\n    programs,\n  });\n  const collectionMetadata = metaplex.nfts().pdas().metadata({\n    mint: collection.address,\n    programs,\n  });\n  const collectionMasterEdition = metaplex.nfts().pdas().masterEdition({\n    mint: collection.address,\n    programs,\n  });\n  const collectionAuthorityRecord = metaplex\n    .nfts()\n    .pdas()\n    .collectionAuthorityRecord({\n      mint: collection.address,\n      collectionAuthority: authorityPda,\n      programs,\n    });\n\n  // Programs.\n  const candyMachineProgram = metaplex.programs().getCandyMachine(programs);\n  const tokenMetadataProgram = metaplex.programs().getTokenMetadata(programs);\n\n  const candyMachineData = toCandyMachineData({\n    itemsAvailable,\n    symbol,\n    sellerFeeBasisPoints,\n    maxEditionSupply,\n    isMutable,\n    creators,\n    itemSettings,\n  });\n\n  const builder = TransactionBuilder.make<CreateCandyMachineBuilderContext>()\n    .setFeePayer(payer)\n    .setContext({ candyMachineSigner: candyMachine });\n\n  let mintAuthority = toPublicKey(authority);\n  if (!withoutCandyGuard) {\n    const createCandyGuard = metaplex\n      .candyMachines()\n      .builders()\n      .createCandyGuard<T>(\n        {\n          base: candyMachine,\n          authority: toPublicKey(authority),\n          guards: params.guards ?? {},\n          groups: params.groups,\n        },\n        { programs, payer }\n      );\n\n    const { candyGuardAddress } = createCandyGuard.getContext();\n    mintAuthority = candyGuardAddress;\n    builder.add(createCandyGuard);\n  }\n\n  return builder\n    .add(\n      await metaplex\n        .system()\n        .builders()\n        .createAccount(\n          {\n            space: getCandyMachineSize(candyMachineData),\n            newAccount: candyMachine,\n            program: candyMachineProgram.address,\n          },\n          { payer, programs }\n        )\n    )\n\n    .add({\n      instruction: createInitializeInstruction(\n        {\n          candyMachine: candyMachine.publicKey,\n          authorityPda,\n          authority: toPublicKey(authority),\n          payer: payer.publicKey,\n          collectionMetadata,\n          collectionMint: collection.address,\n          collectionMasterEdition,\n          collectionUpdateAuthority: collection.updateAuthority.publicKey,\n          collectionAuthorityRecord,\n          tokenMetadataProgram: tokenMetadataProgram.address,\n        },\n        { data: candyMachineData },\n        candyMachineProgram.address\n      ),\n      signers: [payer, candyMachine, collection.updateAuthority],\n      key:\n        params.initializeCandyMachineInstructionKey ?? 'initializeCandyMachine',\n    })\n\n    .when(!withoutCandyGuard, (builder) => {\n      if (!isSigner(authority)) {\n        throw new ExpectedSignerError(\n          'authority',\n          'PublicKey',\n          'In order to create a Candy Machine with an associated ' +\n            'Candy Guard you must provide the authority as a Signer.'\n        );\n      }\n\n      return builder.add(\n        metaplex.candyMachines().builders().wrapCandyGuard(\n          {\n            candyMachine: candyMachine.publicKey,\n            candyMachineAuthority: authority,\n            candyGuard: mintAuthority,\n            candyGuardAuthority: authority,\n            wrapCandyGuardInstructionKey: params.wrapCandyGuardInstructionKey,\n          },\n          { payer, programs }\n        )\n      );\n    });\n};\n"],"names":["Key","createCandyMachineOperation","_createCandyMachineOperation","input","key","createCandyMachineOperationHandler","handle","operation","metaplex","scope","builder","createCandyMachineBuilder","throwIfCanceled","confirmOptions","makeConfirmOptionsFinalizedOnMainnet","output","sendAndConfirm","candyMachine","candyMachines","findByAddress","address","candyMachineSigner","publicKey","params","options","programs","payer","rpc","getDefaultFeePayer","Keypair","generate","authority","identity","collection","sellerFeeBasisPoints","itemsAvailable","symbol","maxEditionSupply","toBigNumber","isMutable","withoutCandyGuard","creators","toPublicKey","share","itemSettings","type","prefixName","nameLength","prefixUri","uriLength","isSequential","authorityPda","pdas","collectionMetadata","nfts","metadata","mint","collectionMasterEdition","masterEdition","collectionAuthorityRecord","collectionAuthority","candyMachineProgram","getCandyMachine","tokenMetadataProgram","getTokenMetadata","candyMachineData","toCandyMachineData","TransactionBuilder","make","setFeePayer","setContext","mintAuthority","createCandyGuard","builders","base","guards","groups","candyGuardAddress","getContext","add","system","createAccount","space","getCandyMachineSize","newAccount","program","instruction","createInitializeInstruction","collectionMint","collectionUpdateAuthority","updateAuthority","data","signers","initializeCandyMachineInstructionKey","when","isSigner","ExpectedSignerError","wrapCandyGuard","candyMachineAuthority","candyGuard","candyGuardAuthority","wrapCandyGuardInstructionKey"],"mappings":"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"}