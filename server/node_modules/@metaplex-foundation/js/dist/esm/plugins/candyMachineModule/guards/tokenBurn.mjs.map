{"version":3,"file":"tokenBurn.mjs","sources":["../../../../../src/plugins/candyMachineModule/guards/tokenBurn.ts"],"sourcesContent":["import { TokenBurn, tokenBurnBeet } from '@metaplex-foundation/mpl-candy-guard';\nimport { CandyGuardManifest } from './core';\nimport {\n  createSerializerFromBeet,\n  mapSerializer,\n  PublicKey,\n  SplTokenAmount,\n  token,\n} from '@/types';\n\n/**\n * The tokenBurn guard restricts minting to token holders\n * of a specified mint account and burns the holder's tokens\n * when minting. The `amount` determines how many tokens are required.\n *\n * This guard alone does not limit how many times a holder\n * can mint. A holder can mint as many times as they have\n * the required amount of tokens to burn.\n *\n * This object defines the settings that should be\n * provided when creating and/or updating a Candy\n * Machine if you wish to enable this guard.\n */\nexport type TokenBurnGuardSettings = {\n  /** The mint address of the required tokens. */\n  mint: PublicKey;\n\n  /** The amount of tokens required to mint an NFT. */\n  amount: SplTokenAmount;\n};\n\n/** @internal */\nexport const tokenBurnGuardManifest: CandyGuardManifest<TokenBurnGuardSettings> =\n  {\n    name: 'tokenBurn',\n    settingsBytes: 40,\n    settingsSerializer: mapSerializer<TokenBurn, TokenBurnGuardSettings>(\n      createSerializerFromBeet(tokenBurnBeet),\n      (settings) => ({ ...settings, amount: token(settings.amount) }),\n      (settings) => ({ ...settings, amount: settings.amount.basisPoints })\n    ),\n    mintSettingsParser: ({ metaplex, settings, payer, programs }) => {\n      const tokenAccount = metaplex.tokens().pdas().associatedTokenAccount({\n        mint: settings.mint,\n        owner: payer.publicKey,\n        programs,\n      });\n\n      return {\n        arguments: Buffer.from([]),\n        remainingAccounts: [\n          {\n            isSigner: false,\n            address: tokenAccount,\n            isWritable: true,\n          },\n          {\n            isSigner: false,\n            address: settings.mint,\n            isWritable: true,\n          },\n        ],\n      };\n    },\n  };\n"],"names":["tokenBurnGuardManifest","name","settingsBytes","settingsSerializer","mapSerializer","createSerializerFromBeet","tokenBurnBeet","settings","amount","token","basisPoints","mintSettingsParser","metaplex","payer","programs","tokenAccount","tokens","pdas","associatedTokenAccount","mint","owner","publicKey","arguments","Buffer","from","remainingAccounts","isSigner","address","isWritable"],"mappings":";;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AASA;AACO,MAAMA,sBAAkE,GAC7E;AACEC,EAAAA,IAAI,EAAE,WAAW;AACjBC,EAAAA,aAAa,EAAE,EAAE;EACjBC,kBAAkB,EAAEC,aAAa,CAC/BC,wBAAwB,CAACC,aAAa,CAAC,EACtCC,QAAQ,KAAM;AAAE,IAAA,GAAGA,QAAQ;AAAEC,IAAAA,MAAM,EAAEC,KAAK,CAACF,QAAQ,CAACC,MAAM,CAAA;GAAG,CAAC,EAC9DD,QAAQ,KAAM;AAAE,IAAA,GAAGA,QAAQ;AAAEC,IAAAA,MAAM,EAAED,QAAQ,CAACC,MAAM,CAACE,WAAAA;AAAY,GAAC,CAAC,CACrE;AACDC,EAAAA,kBAAkB,EAAE,CAAC;IAAEC,QAAQ;IAAEL,QAAQ;IAAEM,KAAK;AAAEC,IAAAA,QAAAA;AAAS,GAAC,KAAK;IAC/D,MAAMC,YAAY,GAAGH,QAAQ,CAACI,MAAM,EAAE,CAACC,IAAI,EAAE,CAACC,sBAAsB,CAAC;MACnEC,IAAI,EAAEZ,QAAQ,CAACY,IAAI;MACnBC,KAAK,EAAEP,KAAK,CAACQ,SAAS;AACtBP,MAAAA,QAAAA;AACF,KAAC,CAAC,CAAA;IAEF,OAAO;AACLQ,MAAAA,SAAS,EAAEC,MAAM,CAACC,IAAI,CAAC,EAAE,CAAC;AAC1BC,MAAAA,iBAAiB,EAAE,CACjB;AACEC,QAAAA,QAAQ,EAAE,KAAK;AACfC,QAAAA,OAAO,EAAEZ,YAAY;AACrBa,QAAAA,UAAU,EAAE,IAAA;AACd,OAAC,EACD;AACEF,QAAAA,QAAQ,EAAE,KAAK;QACfC,OAAO,EAAEpB,QAAQ,CAACY,IAAI;AACtBS,QAAAA,UAAU,EAAE,IAAA;OACb,CAAA;KAEJ,CAAA;AACH,GAAA;AACF;;;;"}